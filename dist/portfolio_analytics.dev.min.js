/*! portfolio_analytics - v0.0.1 (2016-10-06), Roman Rubsamen <roman.rubsamen@gmail.com> */var PortfolioAnalytics=PortfolioAnalytics||{};PortfolioAnalytics=function(a){function b(b){a.assertPositiveNumberArray_(b);var d=c(b,0,b.length-1);return d[0]==-(1/0)?0:d[0]}function c(a,b,c){for(var d=-(1/0),e=-(1/0),f=-1,g=-1,h=-1,i=b;i<c+1;++i){a[i]>d&&(d=a[i],f=i);var j=(d-a[i])/d;j>e&&(e=j,g=f,h=i)}return[e,g,h]}function d(b){var c=-(1/0);a.assertPositiveNumberArray_(b);for(var d=new b.constructor(b.length),e=0;e<b.length;++e)b[e]>c&&(c=b[e]),d[e]=(c-b[e])/c;return d}function e(b,d){if(a.assertPositiveNumberArray_(b),a.assertPositiveInteger_(d),0==d)return[];var e=[],f=[];for(f.push([0,b.length-1,d]);0!=f.length;){var g=f.pop(),h=g[0],i=g[1],j=g[2],k=c(b,h,i),l=k[1],m=k[2],n=k[0];0!=n&&n!=-(1/0)&&e.push([n,l,m]),1==j||l==h&&m==i||(l==h&&m<i?f.push([m,i,j-1]):l>h&&m==i?f.push([h,l,j-1]):(f.push([h,l,j-1]),f.push([m,i,j-1])))}return e.sort(function(a,b){var c=a[0],d=b[0];if(c<d)return 1;if(c>d)return-1;var e=a[1],f=b[1];return e<f?-1:1}),e.slice(0,Math.min(d,e.length))}function f(b){var c=d(b),e=a.dot_(c,c);return Math.sqrt(e/c.length)}function g(b){var c=d(b);return a.mean_(c)}function h(b,c){a.assertBoundedNumber_(c,0,1);var e=d(b).slice(1);if(e.sort(function(a,b){return a-b}),1==c)return e[e.length-1];for(var f=1;c>f/e.length;)++f;var g=e[f-1],h=f/e.length,i=(h-c)*g,j=0;f<e.length&&(j=a.sum_(e.slice(f))/e.length);var k=(i+j)/(1-c);return k}return a.maxDrawdown=function(a){return b(a)},a.drawdownFunction=function(a){return d(a)},a.topDrawdowns=function(a,b){return e(a,b)},a.ulcerIndex=function(a){return f(a)},a.painIndex=function(a){return g(a)},a.conditionalDrawdown=function(a,b){return h(a,b)},a.maxDrawdown_=function(a,b,d){return c(a,b,d)},a}(PortfolioAnalytics||{});var PortfolioAnalytics=PortfolioAnalytics||{};PortfolioAnalytics=function(a){function b(a){if(Object.prototype.toString.call(a).indexOf("Array")==-1)throw new Error("input must be an array")}function c(c){try{b(c)}catch(d){throw new Error("input must be an array of numbers")}if(0==c.length)throw new Error("input must be an array of numbers");for(var e=0;e<c.length;++e)try{a.assertNumber_(c[e])}catch(d){throw new Error("input must be an array of numbers")}}function d(c){try{b(c)}catch(d){throw new Error("input must be an array of positive numbers")}if(0==c.length)throw new Error("input must be an array of positive numbers");for(var e=0;e<c.length;++e)try{a.assertPositiveNumber_(c[e])}catch(d){throw new Error("input must be an array of positive numbers")}}function e(a){if("[object Number]"!=Object.prototype.toString.call(a)||isNaN(a)||a===1/0||a===-(1/0))throw new Error("input must be a number")}function f(a){try{e(a)}catch(b){throw new Error("input must be a positive number")}if(a<0)throw new Error("input must be a positive number")}function g(a,b,c){try{e(a),e(b),e(c)}catch(d){throw new Error("input(s) must be a number")}if(a<b||a>c)throw new Error("input must be bounded between "+b+" and "+c)}function h(a){try{f(a)}catch(b){throw new Error("input must be a positive integer")}if(Math.floor(a)!==a)throw new Error("input must be a positive integer")}function i(a){if(!("string"==typeof a||a instanceof String))throw new Error("input must be a string")}function j(a,c){try{b(c)}catch(d){throw new Error("input must be an array of strings")}for(var e=0;e<c.length;++e)try{i(c[e])}catch(d){throw new Error("input must be an array of strings")}try{i(a)}catch(d){throw new Error("input must be a string equals to any of "+c.toString())}if(c.indexOf(a)==-1)throw new Error("input must be a string equals to any of "+c.toString())}return a.assertArray_=function(a){return b(a)},a.assertNumberArray_=function(a){return c(a)},a.assertPositiveNumberArray_=function(a){return d(a)},a.assertNumber_=function(a){return e(a)},a.assertPositiveNumber_=function(a){return f(a)},a.assertBoundedNumber_=function(a,b,c){return g(a,b,c)},a.assertPositiveInteger_=function(a){return h(a)},a.assertString_=function(a){return i(a)},a.assertStringEnumeration_=function(a,b){return j(a,b)},a}(PortfolioAnalytics||{});var PortfolioAnalytics=PortfolioAnalytics||{};PortfolioAnalytics=function(a){function b(b){a.assertPositiveNumberArray_(b);var c=NaN;return b.length>=2&&(c=(b[b.length-1]-b[0])/b[0]),c}function c(b,c){a.assertPositiveNumberArray_(b),a.assertStringEnumeration_(c,["daily","weekly","monthly","quarterly","yearly"]);var d=b[0],e=b[b.length-1],f=b.length-1;"yearly"==c?f/=1:"quarterly"==c?f/=4:"monthly"==c?f/=12:"weekly"==c?f/=52:"daily"==c&&(f/=252);var g=Math.pow(e/d,1/f)-1;return g}function d(b){a.assertPositiveNumberArray_(b);var c=new b.constructor(b.length);c[0]=NaN;for(var d=1;d<b.length;++d)c[d]=(b[d]-b[d-1])/b[d-1];return c}function e(b,c){a.assertBoundedNumber_(c,0,1);var e=d(b).slice(1);return e.sort(function(a,b){return a-b}),w=Math.floor(c*e.length),0==w?NaN:(valAtRisk=-e[w-1],valAtRisk)}return a.cumulativeReturn=function(a){return b(a)},a.cagr=function(a,b){return c(a,b)},a.arithmeticReturns=function(a){return d(a)},a.valueAtRisk=function(a,b){return e(a,b)},a}(PortfolioAnalytics||{});var PortfolioAnalytics=PortfolioAnalytics||{};PortfolioAnalytics=function(a){function b(b,c,d){if(a.assertNumberArray_(b),a.assertPositiveInteger_(c),nn=b.length,dtemp=0,m=nn%4,0!=m)for(var e=0;e<m;e++)dtemp+=Math.pow(Math.max(0,b[e]-d),c);if(nn<4)return dtemp/nn;for(var e=m;e<nn;e+=4)dtemp+=Math.pow(Math.max(0,b[e]-d),c)+Math.pow(Math.max(0,b[e+1]-d),c)+(Math.pow(Math.max(0,b[e+2]-d),c)+Math.pow(Math.max(0,b[e+3]-d),c));return dtemp/nn}function c(b,c,d){a.assertNumberArray_(b),a.assertPositiveInteger_(c);var e=b.length,f=0,g=e%4;if(0!=g)for(var h=0;h<g;h++)f+=Math.pow(Math.max(0,d-b[h]),c);if(e<4)return f/e;for(var h=g;h<e;h+=4)f+=Math.pow(Math.max(0,d-b[h]),c)+Math.pow(Math.max(0,d-b[h+1]),c)+(Math.pow(Math.max(0,d-b[h+2]),c)+Math.pow(Math.max(0,d-b[h+3]),c));return f/e}function d(b){a.assertNumberArray_(b);var c=b.length;return a.sum_(b)/c}return a.hpm_=function(a,c,d){return b(a,c,d)},a.lpm_=function(a,b,d){return c(a,b,d)},a.mean_=function(a){return d(a)},a}(PortfolioAnalytics||{});var PortfolioAnalytics=PortfolioAnalytics||{};PortfolioAnalytics=function(a){function b(b){a.assertNumberArray_(b);var c=b.length,d=0,e=c%4;if(0!=e)for(var f=0;f<e;f++)d+=b[f];if(c<4)return d;for(var f=e;f<c;f+=4)d+=b[f]+b[f+1]+(b[f+2]+b[f+3]);return d}function c(b,c){if(a.assertNumberArray_(b),a.assertNumberArray_(c),b.length!=c.length)throw new Error("input arrays must have the same length");var d=b.length,e=0,f=d%4;if(0!=f)for(var g=0;g<f;g++)e+=b[g]*c[g];if(d<4)return e;for(var g=f;g<d;g+=4)e+=b[g]*c[g]+b[g+1]*c[g+1]+(b[g+2]*c[g+2]+b[g+3]*c[g+3]);return e}return a.sum_=function(a){return b(a)},a.dot_=function(a,b){return c(a,b)},a}(PortfolioAnalytics||{});var PortfolioAnalytics=PortfolioAnalytics||{};PortfolioAnalytics=function(a){function b(b){var c=a.arithmeticReturns(b).slice(1);if(0==c.length)return NaN;var d=a.mean_(c),e=a.lpm_(c,1,0);return 0==e?NaN:d/e}return a.gainToPainRatio=function(a){return b(a)},a}(PortfolioAnalytics||{});